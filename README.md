# ChatGPT 下载回答图片

一个 Tampermonkey（油猴）脚本，在 ChatGPT 网页的分享弹窗中新增下载图片按钮，把当前回答以官方排版导出为图片，便于在无法访问分享链接或仅允许上传截图的平台分发与归档。

## 适用动机

* 分享链接在部分网络环境下不可达。
* 复制 Markdown 到第三方平台容易出现样式错乱。
* 许多网站只允许上传截图而不允许粘贴 AI 文本。
* 希望保留官方排版的观感，做到所见即所得。

## 功能特性

* 在分享弹窗内新增一个与复制链接同版式的下载图片按钮。
* 以离屏克隆方式渲染官方预览卡片，导出 PNG，保留圆角与阴影。
* 默认较高像素比，兼顾清晰度和体积。
* 成功与失败均有轻量提示，不干扰页面操作。

## 支持范围

* 站点匹配

  * `https://chatgpt.com/c/*`
  * `https://chat.openai.com/c/*`
* 浏览器与脚本管理器

  * 推荐最新版 Chrome 或 Edge
  * Tampermonkey

## 安装

### 一键安装

先安装 Tampermonkey。然后打开下方 Raw 链接，浏览器会弹出安装对话框。

**Raw 安装链接：**

  `https://raw.githubusercontent.com/chixi4/chatgpt-answer-image-dl/main/ChatGPT%20下载回答图片.user.js`

### 备用安装

在仓库页面进入脚本文件，点击 Raw 按钮即可获取原始链接。也可以下载 `.user.js` 后，在 Tampermonkey 仪表盘中新建脚本并粘贴保存。

## 使用方法

在任意回答下点击分享，弹出分享弹窗后，点击新增的下载图片按钮。等待脚本渲染完成，浏览器开始保存图片到下载目录；在支持的模式下会弹出保存对话框。

## 权限与设置

脚本使用 `GM_download` 保存图片，需要在 Tampermonkey 中允许下载能力，并将 `png` 后缀加入白名单。未启用、未在白名单或未授予权限时，Tampermonkey 可能报出相应错误。具体入口位于 Tampermonkey 的选项页。

## 核心实现思路

* 监听分享弹窗出现，定位复制链接按钮，克隆一枚同尺寸按钮插入其上方。
* 将弹窗内容克隆到离屏容器，定向调整会影响截图的样式与蒙层。
* 使用 `html-to-image` 将预览卡片渲染为 `Blob`，通过 `GM_download` 触发保存。
* 完成后清理离屏节点，恢复按钮状态与提示文案。

## 常见问题

* 看不到下载图片按钮

  * 确认已经点击了分享，并且弹窗内容加载完成。
  * 页面结构若更新，可能需要升级脚本版本以适配新的选择器。
* 点击后下载失败

  * 优先检查 Tampermonkey 是否启用下载功能并允许 `png` 后缀。
  * 查看控制台日志，脚本会打印失败原因。
* 文件名或保存路径与预期不一致

  * 受浏览器与下载模式差异影响，最终文件名可能被系统调整，保存路径通常为默认下载目录。
* 图片过大或生成较慢

  * 默认像素比偏高以保证清晰度。需要更小体积时，可以在源码中将 `pixelRatio` 固定为 `2`。

## 更新说明

脚本头部已配置 `@downloadURL` 与 `@updateURL` 指向 Raw 原始文件地址。每次发布请提升 `@version`，Tampermonkey 会按该地址检查更新。
建议同时在 GitHub Releases 打上对应的标签并简述改动点，便于回溯。

## 目录与文件

```
chatgpt-answer-image-dl/
├─ ChatGPT 下载回答图片.user.js 或 chatgpt-answer-image.user.js
├─ LICENSE
└─ README.md
```

## 许可证

MIT

## 致谢

* `html-to-image` 用于将 DOM 渲染为图片。
* Tampermonkey 提供脚本运行与下载接口。

需要我把上面的 Raw 链接替换成你仓库的实际地址，也可以直接告诉我当前脚本文件名，我给你生成最终可用的安装链接版本。
